<!DOCTYPE html>
<html lang="en">
<head>
   <%- include('./partials/head') %>
    <title>Home - BlogUp</title>
</head>
<body>
   <%- include('./partials/nav') %>
   
   <div class="home-container">
      <div class="home-header">
         <h1 class="home-title">Discover Stories</h1>
         <p class="home-subtitle">Read, write, and share your thoughts with the world</p>
      </div>

      <% if (blogs && blogs.length > 0) { %>
         <div class="blogs-grid">
            <% blogs.forEach(blog => { %>
               <% 
                  const words = blog.body ? blog.body.split(/\s+/).length : 0;
                  const readingTime = Math.max(1, Math.ceil(words / 200));
                  let authorName = blog.createdBy ? (blog.createdBy.fullName || blog.createdBy.email || 'Anonymous') : 'Anonymous';
               
                  authorName = authorName.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(' ');
               %>
               <a href="/blog/<%= blog._id %>" class="card-modern blog-card-link">
                  <% if (blog.coverImageUrl) { %>
                     <img src="<%= blog.coverImageUrl %>" alt="<%= blog.title %>" />
                  <% } %>
                  <div class="card-modern-body">
                     <h3 class="card-modern-title"><%= blog.title %></h3>
                     <div class="card-modern-meta">
                        <span class="card-author"><%= authorName %></span>
                        <span class="card-reading-time"><%= readingTime %> min read</span>
                     </div>
                  </div>
               </a>
            <% }) %>
         </div>
      <% } else { %>
         <div class="text-center mt-section">
            <h2>No blogs yet</h2>
            <p class="text-muted">Be the first to share your story!</p>
            <% if (locals.user) { %>
               <a href="/blog/add-blog" class="btn-modern mt-3">Write Your First Blog</a>
            <% } else { %>
               <a href="/user/signup" class="btn-modern mt-3">Get Started</a>
            <% } %>
         </div>
      <% } %>
   </div>

   <%- include('./partials/script') %>
</body>
</html>